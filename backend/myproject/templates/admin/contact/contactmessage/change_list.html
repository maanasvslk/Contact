{% extends "admin/change_list.html" %}

{% block result_list %}
  <h2>All Messages Across Databases</h2>

  <!-- Loop through each database version group -->
  {% for db_name, messages in all_messages.items %}
    <h3>Messages in {{ db_name|capfirst }} Database</h3>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          {% if db_name == 'v2' %}
            <th>Phone Number</th>
            <th>Address</th>
          {% endif %}
          <th>Message</th>
          <th>Submitted At</th>
        </tr>
      </thead>
      <tbody>
        <!-- Loop through the messages for this database -->
        {% for msg in messages %}
          <tr>
            <td>{{ msg.name }}</td>
            <td>{{ msg.email }}</td>
            {% if db_name == 'v2' %}
              <td>{{ msg.phone_number }}</td>
              <td>{{ msg.address }}</td>
            {% endif %}
            <td>{{ msg.message }}</td>
            <td>{{ msg.submitted_at }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}

  {{ block.super }}
{% endblock %}
